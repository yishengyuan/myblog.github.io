## **1️⃣ JVM如何确定垃圾对象**

JVM使用**可达性分析算法（Reachability Analysis）**来判断对象是否垃圾：

1. **标记阶段（Mark）**
    
    - 从一组称为 **GC Roots** 的对象开始，沿着引用链遍历所有可达对象。
        
    - 能从GC Roots访问到的对象被认为**存活**。
        
2. **清除阶段（Sweep）或复制阶段（Copy）**
    
    - 未被标记为可达的对象就是**垃圾**，可以回收内存。
        

> 也就是说，垃圾对象是**不可从GC Roots访问到的对象**。

## **2️⃣ 什么是GC Roots**

GC Roots 是一组**起点对象**，垃圾回收器从这些对象开始向下遍历引用图。常见的GC Roots有：

1. **虚拟机栈（栈帧中的本地变量）中的引用**
    
    - 方法中局部变量引用的对象
        
    - 线程执行栈上的对象
        
2. **方法区中的类静态属性引用的对象**
    
    - static 变量引用的对象
        
3. **方法区中的常量引用的对象**
    
    - 字符串常量池、常量引用
        
4. **本地方法栈中JNI引用的对象**
    
    - 通过JNI调用的对象引用
## **3️⃣ 可达性分析示意**

假设对象图如下：

`GC Roots → A → B → C           → D E（无引用）`

- 从GC Roots出发：A、B、C、D都是可达对象 → 不回收
    
- E 没有被任何GC Roots引用 → 垃圾 → 回收
    

---

## **4️⃣ JVM垃圾回收的基本流程**

1. **标记（Mark）**
    
    - 从GC Roots出发，标记所有可达对象
        
2. **清除（Sweep）** 或 **复制（Copy）**
    
    - 未标记的对象回收
        
    - 分代收集：Young GC/Minor GC 多使用复制算法，Old GC/Full GC 多用标记-整理或标记-清除
✅ **总结**：

- **垃圾对象**：不可从GC Roots访问的对象
    
- **GC Roots**：垃圾回收的起点，一般包括：
    
    - 栈帧中的局部变量
        
    - 静态变量
        
    - 常量
        
    - JNI引用