### 1️⃣ 问题分析

- Redis Cluster 的客户端请求是 **按 key 的 slot 路由**到对应节点。
    
- 当你新加一个节点时，它 **默认还没有被分配 slot**（也就是没有数据）。
    
- 如果客户端直接把请求发到新节点：
    
    - 新节点可能没有对应 key → 返回 `MOVED` 或 `ASK` 重定向
        
    - 频繁 `MOVED` 会增加延迟
        
    - 如果客户端不支持 Cluster 路由，可能直接访问新节点会导致读不到数据
        

所以问题本质是 **新节点在没有 slot 前不能直接作为目标节点服务请求**。

---

### 2️⃣ 解决方案

#### 方案 A：使用 Cluster-aware 客户端（推荐）

- 大多数 Redis Cluster 驱动都会处理 `MOVED` 和 `ASK` 响应
    
- 客户端请求任意节点时，如果目标 key 不在该节点，会被重定向到正确节点
    
- **新节点可以加入集群，但先不要主动给客户端路由 key**
    
- 当执行 slot 迁移后，新节点才开始承载请求
    

✅ 优点：不需要停机，Redis 内置支持

---

#### 方案 B：控制客户端连接策略

- 扩容新节点时，先 **不把新节点的地址暴露给客户端**
    
- 等 slot 迁移完成、数据分布均衡后，再把新节点加入客户端配置
    
- 避免客户端在迁移前直接访问新节点
    

---

#### 方案 C：先迁移 slot，再接入客户端

- 可以在后台执行 slot reshard：
    
    1. 新节点加入集群
        
    2. 迁移部分 slot 从老节点到新节点
        
    3. 等 slot 迁移完成后，客户端开始访问新节点
        

这样可以避免“请求落到空节点”的问题。

---

### 3️⃣ 总结

|场景|做法|
|---|---|
|新节点加入，但客户端可能访问|使用 Cluster-aware 客户端，让客户端处理 MOVED/ASK 重定向|
|避免新节点接收请求太早|扩容前不要暴露新节点给客户端，等 slot 迁移完成再接入|
|保证负载均衡|执行 slot reshard，把部分 slot 分配到新节点|

---

💡 **重点**：Redis Cluster 的核心原则是 **客户端请求一定按照 slot 路由到正确节点**。只要客户端支持 Cluster 路由，访问新节点没问题，只是可能会有短暂的重定向。