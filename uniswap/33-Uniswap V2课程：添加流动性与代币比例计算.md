### Uniswap V2课程：添加流动性与代币比例计算

#### 要点总结

1. **流动性添加基本原理**：

   - 在Uniswap V2中，添加流动性时，需要提供两种代币：代币X和代币Y。给定其中一种代币的数量，可以通过公式计算需要提供的另一种代币的数量。
   - 流动性添加前后的价格必须相同，意味着添加流动性时，代币X和代币Y的比例必须保持一致。

2. **常数积模型**：

   - Uniswap使用常数积模型：X * Y = L²，其中L为常数（例如L=100）。
   - 添加流动性时，AMM曲线将向右上方平移，并且随着流动性增加，曲线变得更加平坦。

3. **价格不变的条件**：

   - 在添加流动性前，代币X和代币Y的数量决定了AMM的价格（即代币X相对于代币Y的价格），该价格由代币Y与代币X的比值（Y / X）表示。
   - 在流动性添加后，AMM的价格应该保持不变，因此代币X和代币Y的比例也必须保持一致。

4. **直线法则**：

   - 如果画一条从原点到添加流动性前的点的直线，这条直线的斜率表示当前价格（即Y / X）。
   - 在添加流动性后，新的代币X和代币Y的数量必须在这条直线上。
   - 直线的斜率不变，意味着无论如何添加流动性，新的代币数量必须沿着这条直线调整。

5. **实例分析**：

   - 价格为1时

     ：

     - 如果想要从蓝色曲线移动到紫色曲线，且假设我们要添加280个代币X，那么需要添加相同数量的代币Y，即280个。

   - 价格高于1时

     ：

     - 如果添加197个代币X，则需要添加更多的代币Y，例如395个。

   - 价格低于1时

     ：

     - 如果价格小于1，则需要添加更多的代币X，而不是代币Y。

6. **总结**：

   - 向常数积AMM（如Uniswap）添加流动性时，代币X和代币Y的数量必须沿着一条直线调整，该直线是通过从原点到当前代币X和代币Y数量的点画出的。
   - 根据当前价格（Y / X的比值），可以计算出需要添加多少代币X和代币Y，以确保价格不变。

通过本节内容，学员可以理解在Uniswap V2中如何根据常数积模型和价格保持不变的条件来计算需要添加的流动性数量。