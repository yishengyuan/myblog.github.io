# Uniswap V2 常数乘积自动做市商（AMM）机制课程大纲

## 课程内容概述

本节课将介绍 Uniswap V2 中常数乘积自动做市商（AMM）的工作原理，解答以下问题：
1. 如何通过常数乘积曲线计算交易中兑换的代币数量？
2. 曲线中的常数 \( L \) 的含义及其在 AMM 中的作用。

## 知识点概述

### 1. 常数乘积方程与代币兑换数量的关系
- **公式**：Uniswap V2 的常数乘积方程为 \( x \times y = L \)，其中 \( x \) 和 \( y \) 分别表示 AMM 池中代币 X 和代币 Y 的数量，\( L \) 为常数。
- **曲线含义**：所有合法的代币组合 \( (x, y) \) 都必须在曲线上，例如初始状态下 \( x = 200, y = 200 \)。
- **代币数量变化**：在曲线上的任意点，如果增加一种代币的数量，另一种代币的数量会随之调整以保持 \( x \times y = L \) 恒定。例如，将代币 X 增加到 400 时，代币 Y 会相应减少到 100。

### 2. 交易中的代币输入和输出计算
- **示例**：假设 AMM 池初始状态为 \( x = 200, y = 200 \)，如果向池中增加 200 个代币 Y，那么为了保持恒等式成立，代币 X 会减少到 100。这说明输入 200 个代币 Y 时，200 - 100 = 100 个代币 X 会从池中流出。
- **反向交易示例**：如果增加 100 个代币 X，使 \( x \) 从 200 增加到 300，那么 \( y \) 将减少到 133，对应的输出代币 Y 数量为 -66。

### 3. 常数 \( L \) 的含义及其影响
- **定义**：\( L \) 通常称为“流动性”，表示池子的规模。\( L \) 值越大，池子越大。
- **曲线变化**：增大 \( L \) 会使曲线变得更“平滑”，并扩大价格区间。
- **价格影响**：流动性较高的池子能提供更好的兑换率。例如，当 \( L = 200 \) 时，输入 200 个代币 X 可获得 100 个代币 Y；当 \( L = 400 \) 时，输入相同的代币 X 可以获得 133 个代币 Y。这意味着池子越大，兑换代币时的“滑点”越小。

## 课程复习要点
- 理解 **常数乘积方程 \( x \times y = L \)** 的基本原理。
- 熟悉如何根据曲线上的点计算代币输入和输出数量。
- 掌握流动性 \( L \) 对交易汇率的影响，特别是流动性越高，滑点越小，价格越优。

---